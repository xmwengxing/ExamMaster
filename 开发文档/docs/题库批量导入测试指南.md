# 题库批量导入测试指南

## 测试准备

### 1. 下载测试文件
项目根目录已包含测试文件：`test-questions-import.csv`

### 2. 登录管理员账号
- 访问系统管理后台
- 使用管理员账号登录

## 测试步骤

### 步骤1：下载新模板
1. 进入 **题库管理**
2. 选择任意题库，点击 **内容管理**
3. 点击 **批量导入** 按钮
4. 点击 **获取题目导入CSV模板**
5. 查看下载的模板文件，注意新增的示例和说明

### 步骤2：验证模板格式
新模板应包含以下内容：
- 详细的导入说明（以#开头的注释）
- 5个示例题目，包括：
  - 标准单选题（4个选项）
  - 判断题
  - 标准多选题（4个选项）
  - 包含逗号的多选题（6个选项）
  - 包含逗号的单选题（7个选项）

### 步骤3：测试标准导入
1. 使用下载的模板文件
2. 点击 **批量导入** → 上传模板文件
3. 验证导入结果：应显示 "✓ 成功导入 5 题"

### 步骤4：测试错误处理
创建一个包含错误的CSV文件：
```csv
题型(SINGLE/MULTIPLE/JUDGE),题干,选项(用|分隔;判断题可留空),答案(如A或ABC),解析
SINGEL,这是一个错误的题型,,A,题型拼写错误
SINGLE,,选项A|选项B,A,题干为空
SINGLE,正常题目,选项A,Z,答案超出范围
MULTIPLE,多选题,选项A|选项B|选项C,ABC,正常题目
```

上传后应显示：
- 发现3条错误
- 成功解析1题
- 询问是否继续导入有效题目

### 步骤5：测试特殊字符
创建包含特殊字符的CSV：
```csv
题型(SINGLE/MULTIPLE/JUDGE),题干,选项(用|分隔;判断题可留空),答案(如A或ABC),解析
SINGLE,"题干中包含逗号，这是测试",选项A|选项B|选项C,A,"解析中也包含逗号，测试"
MULTIPLE,"多选题，包含特殊字符：引号""和逗号，",选项A|选项B|选项C|选项D|选项E,ABCDE,测试5个选项
```

应成功导入2题，且题干和解析正确显示逗号。

### 步骤6：测试多选项支持
创建包含多个选项的题目：
```csv
题型(SINGLE/MULTIPLE/JUDGE),题干,选项(用|分隔;判断题可留空),答案(如A或ABC),解析
SINGLE,测试8个选项,选项A|选项B|选项C|选项D|选项E|选项F|选项G|选项H,H,最多支持8个选项
MULTIPLE,测试6个选项,选项A|选项B|选项C|选项D|选项E|选项F,ABCDEF,多选题6个选项
SINGLE,测试2个选项,选项A|选项B,A,最少2个选项
```

应成功导入3题。

### 步骤7：测试边界情况
创建边界测试CSV：
```csv
题型(SINGLE/MULTIPLE/JUDGE),题干,选项(用|分隔;判断题可留空),答案(如A或ABC),解析
SINGLE,超过8个选项,A|B|C|D|E|F|G|H|I,I,应该报错
SINGLE,只有1个选项,选项A,A,应该报错
JUDGE,判断题答案错误,,C,应该报错
MULTIPLE,多选答案超范围,A|B|C,ABCD,应该报错
```

应显示4条错误，0题导入成功。

## 测试检查清单

### 功能测试
- [ ] 标准格式导入成功
- [ ] 包含逗号的题干正确解析
- [ ] 包含逗号的解析正确解析
- [ ] 2-8个选项都能正确导入
- [ ] 单选题答案验证正确
- [ ] 多选题答案验证正确
- [ ] 判断题答案验证正确

### 错误处理测试
- [ ] 题型错误能正确识别
- [ ] 题干为空能正确识别
- [ ] 选项数量不足能正确识别
- [ ] 选项数量超限能正确识别
- [ ] 答案超出范围能正确识别
- [ ] 答案格式错误能正确识别
- [ ] 错误提示包含行号
- [ ] 错误提示说明具体原因

### 用户体验测试
- [ ] 模板下载正常
- [ ] 模板包含详细说明
- [ ] 模板包含多种示例
- [ ] 导入成功有明确提示
- [ ] 导入失败有详细错误信息
- [ ] 部分成功时询问是否继续
- [ ] 导入后题目正确显示

## 常见问题

### Q1: 上传CSV后提示"导入失败"
**A:** 检查以下几点：
1. 文件编码是否为UTF-8
2. 第一行是否为标题行
3. 是否有空行或格式错误

### Q2: 题干中的逗号显示不正确
**A:** 确保包含逗号的字段用英文双引号包裹：
```csv
SINGLE,"题干中有逗号，需要引号",选项A|选项B,A,解析
```

### Q3: 多选题答案格式
**A:** 多选题答案直接连写，不需要分隔符：
- 正确：`ABC`
- 错误：`A,B,C` 或 `A|B|C`

### Q4: 判断题如何填写
**A:** 判断题格式：
```csv
JUDGE,题干内容,,A,解析
```
- 选项列留空
- 答案A表示正确，B表示错误

### Q5: 支持多少个选项
**A:** 
- 最少：2个选项
- 最多：8个选项
- 判断题：固定2个选项（正确/错误）

## 性能测试

### 大批量导入测试
1. 准备100题的CSV文件
2. 上传并记录导入时间
3. 验证所有题目正确导入
4. 检查系统响应速度

### 预期性能指标
- 100题导入时间：< 5秒
- 500题导入时间：< 20秒
- 1000题导入时间：< 40秒

## 回归测试

### 兼容性测试
使用旧版本的CSV文件测试，确保向后兼容：
```csv
题型,题干,选项,答案,解析
SINGLE,旧格式题目,A|B|C|D,A,旧格式解析
```

应能正常导入。

## 测试报告模板

```
测试日期：____年__月__日
测试人员：________
测试环境：生产环境 / 测试环境

测试结果：
✓ 标准导入：通过 / 失败
✓ 特殊字符：通过 / 失败
✓ 多选项：通过 / 失败
✓ 错误处理：通过 / 失败
✓ 边界测试：通过 / 失败

发现问题：
1. ________________
2. ________________

建议：
1. ________________
2. ________________
```

## 联系支持

如遇到问题，请提供：
1. 测试的CSV文件
2. 错误截图
3. 浏览器控制台日志
4. 服务器日志（如有权限）
